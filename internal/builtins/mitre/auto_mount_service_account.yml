id: auto-mount-service-account-token
match:
  resources:
    - group: apps
      version: v1
      resource: deployments
    - group: apps
      version: v1
      resource: daemonsets
    - group: apps
      version: v1
      resource: statefulsets
    - group: apps
      version: v1
      resource: replicasets
    - group: batch
      version: v1
      resource: cronjobs
    - group: batch
      version: v1
      resource: jobs
validations:
  - expression: >
      has(podSpec.automountServiceAccountToken) && podSpec.automountServiceAccountToken == false
    message: "Pod with Service Account token mounted automatically"
